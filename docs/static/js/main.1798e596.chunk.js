(this.webpackJsonpcards=this.webpackJsonpcards||[]).push([[0],{68:function(e,t,n){},76:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),i=n(11),o=n.n(i),s=(n(68),n(15)),l=n(32),u=n(8),d=n(34),j=n(35),b="".concat("http://192.168.1.3:80","/cards"),f=new(function(){function e(){Object(d.a)(this,e)}return Object(j.a)(e,[{key:"_get",value:function(e){return fetch(e).then((function(e){return e.json()}))}},{key:"_post",value:function(e,t){return Promise.resolve().then((function(){return JSON.stringify(t)})).then((function(t){return fetch(e,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:t})})).then((function(e){return e.json()}))}},{key:"getUser",value:function(e){return this._get("".concat(b,"/user/").concat(e))}},{key:"getAll",value:function(){return this._get("".concat(b,"/all"))}},{key:"delete",value:function(e){return this._get("".concat(b,"/delete/").concat(e))}},{key:"add",value:function(e){return this.update(e)}},{key:"update",value:function(e){return this._post("".concat(b,"/upsert"),e)}}]),e}()),p={FRESH:"fresh",HIGH:"high",MEDIUM:"medium",LOW:"low"},O=(a={},Object(s.a)(a,p.FRESH,1e3),Object(s.a)(a,p.HIGH,3),Object(s.a)(a,p.MEDIUM,2),Object(s.a)(a,p.LOW,1),a),h=new(function(){function e(){Object(d.a)(this,e),this._cards=[],this._user=""}return Object(j.a)(e,[{key:"_getCard",value:function(e){return this._cards.find((function(t){return t.id===e}))}},{key:"_getPriority",value:function(){var e=this,t=0;return Object.keys(O).reduce((function(n,a){var r=Math.random()*O[a];return r<=t||!e._cards.find((function(e){return e.priority===a}))?n:(t=r,a)}),"")}},{key:"init",value:function(e){var t=this;return f.getUser(e).then((function(e){return t._user=e.user,f.getAll()})).then((function(e){return t._cards=e,t._user}))}},{key:"getActiveCard",value:function(){var e=this;return new Promise((function(t,n){var a=e._getPriority(),r=e._cards.filter((function(e){return e.priority===a})).reduce((function(e,t){return e&&e.lastSeenAt<t.lastSeenAt?e:t}),null);r?(r.lastSeenAt=Date.now(),t(r)):n("no active card")}))}},{key:"shuffleCards",value:function(){}},{key:"rankCard",value:function(e,t){var n=this._getCard(e),a=Object(u.a)(Object(u.a)({},n),{},{priority:t}),r=Object.values(p);return r.indexOf(a.priority)<r.indexOf(n.priority)&&(a.lastSeenAt=0),f.update(a).then((function(e){n.priority=e.priority,n.lastSeenAt=e.lastSeenAt}))}},{key:"deleteCard",value:function(e){var t=this;return f.delete(e).then((function(e){t._cards.splice(t._cards.indexOf(t._cards.find((function(t){return t.id===parseInt(e.id,10)}))),1)}))}},{key:"updateCard",value:function(e){var t=this;if(!e.id)return f.add({translations:e.translations,example:e.example,priority:p.FRESH,lastSeenAt:Date.now()}).then((function(e){t._cards.push(e)}));var n=this._getCard(e.id);return n?f.update(Object(u.a)(Object(u.a)({},n),{},{translations:Object(u.a)(Object(u.a)({},n.translations),e.translations),example:e.example})).then((function(e){n.translations=e.translations,n.example=e.example})):Promise.reject("no card to update")}}]),e}()),m=n(108),x=n(111),g=n(113),v=n(120),y=n(116),k=n(117),C=n(118),S=n(119),w=n(122),_=n(123),N=n(121),A=n(6),T="set-user",H="set-card",P="turn-card",M={user:null,card:null,cardTurned:!1},D=function(e,t){switch(t.type){case T:return Object(u.a)(Object(u.a)({},e),{},{user:t.user});case H:return Object(u.a)(Object(u.a)({},e),{},{card:t.card,cardTurned:!1});case P:return Object(u.a)(Object(u.a)({},e),{},{cardTurned:!e.cardTurned});default:return Object(u.a)({},e)}},E=Object(m.a)((function(e){return{root:{width:"".concat(window.innerWidth,"px"),height:"".concat(window.innerHeight,"px"),display:"grid",gridTemplateRows:"auto 112px",backgroundColor:e.palette.grey[100]},card:{width:"330px",justifySelf:"center",alignSelf:"center",overflow:"visible"},cardContent:{position:"relative",height:"190px",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},translations:{fontSize:"24px",textAlign:"center"},example:{fontSize:"14px",textAlign:"center",marginTop:"10px"},cardActions:{position:"absolute",bottom:"-72px",display:"flex",justifyContent:"center"},rankButton:{margin:"0 16px"},rbFresh:{backgroundColor:e.palette.error.dark},rbHigh:{backgroundColor:e.palette.warning.main},rbMedium:{backgroundColor:e.palette.success.main},rbLow:{backgroundColor:e.palette.info.light},speedDial:{position:"fixed",right:"28px",bottom:"28px"},editor:{padding:"20px",alignSelf:"center"},editorActions:{width:"210px",justifySelf:"center",alignSelf:"center",display:"flex",justifyContent:"space-between"}}}));var F=function(){var e=E(),t=Object(r.useReducer)(D,M),n=Object(l.a)(t,2),a=n[0],c=n[1],i=Object(r.useState)(!1),o=Object(l.a)(i,2),d=o[0],j=o[1],b=Object(r.useState)(!1),f=Object(l.a)(b,2),O=f[0],m=f[1],F=Object(r.useState)(null),I=Object(l.a)(F,2),B=I[0],L=I[1],W=Object(r.useCallback)((function(){h.getActiveCard().then((function(e){return c({card:e,type:H})})).catch((function(e){console.log(e),c({card:null,type:H})}))}),[c]),z=Object(r.useCallback)((function(e,t,n){e.stopPropagation(),h.rankCard(t,n).then(W)}),[W]);Object(r.useEffect)((function(){h.init("meyer").then((function(e){return c({type:T,user:e})})).then((function(){return h.getActiveCard()})).then((function(e){return c({card:e,type:H})})).catch((function(e){return console.log(e)}))}),[c]);var R=null;return O?R=Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(x.a,{variant:"contained",onClick:function(e){e.stopPropagation(),m(!1)},children:Object(A.jsx)("span",{className:"material-icons",children:"clear"})},"clear"),Object(A.jsx)(x.a,{variant:"contained",color:"secondary",onClick:function(e){e.stopPropagation(),h.deleteCard(a.card.id).then((function(){m(!1),W()}))},children:Object(A.jsx)("span",{className:"material-icons",children:"delete"})},"delete")]}):a.cardTurned&&(R=Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)(g.a,{className:"".concat(e.rankButton," ").concat(e.rbFresh),size:"small",onClick:function(e){return z(e,a.card.id,p.FRESH)}},"rb-fresh"),Object(A.jsx)(g.a,{className:"".concat(e.rankButton," ").concat(e.rbHigh),size:"small",onClick:function(e){return z(e,a.card.id,p.HIGH)}},"rb-high"),Object(A.jsx)(g.a,{className:"".concat(e.rankButton," ").concat(e.rbMedium),size:"small",onClick:function(e){return z(e,a.card.id,p.MEDIUM)}},"rb-medium"),Object(A.jsx)(g.a,{className:"".concat(e.rankButton," ").concat(e.rbLow),size:"small",onClick:function(e){return z(e,a.card.id,p.LOW)}},"rb-low")]})),B?Object(A.jsxs)("div",{className:e.root,children:[Object(A.jsxs)("div",{className:e.editor,children:[Object.keys(B.translations.from).map((function(e,t){return Object(A.jsx)(v.a,{id:e,label:e,margin:"normal",value:B.translations.from[e],onChange:function(t){return L((function(n){return Object(u.a)(Object(u.a)({},n),{},{translations:Object(u.a)(Object(u.a)({},n.translations),{},{from:Object(u.a)(Object(u.a)({},n.translations.from),{},Object(s.a)({},e,t.target.value))})})}))},fullWidth:!0},t)})),Object.keys(B.translations.to).map((function(e,t){return Object(A.jsx)(v.a,{id:e,label:e,margin:"normal",value:B.translations.to[e],onChange:function(t){return L((function(n){return Object(u.a)(Object(u.a)({},n),{},{translations:Object(u.a)(Object(u.a)({},n.translations),{},{to:Object(u.a)(Object(u.a)({},n.translations.to),{},Object(s.a)({},e,t.target.value))})})}))},fullWidth:!0},t)})),Object(A.jsx)(v.a,{id:"example",label:"Beispiel",margin:"normal",value:B.example,onChange:function(e){return L((function(t){return Object(u.a)(Object(u.a)({},t),{},{example:e.target.value})}))},fullWidth:!0})]}),Object(A.jsxs)("div",{className:e.editorActions,children:[Object(A.jsx)(x.a,{variant:"contained",onClick:function(){return L(null)},children:"Abbrechen"}),Object(A.jsx)(x.a,{variant:"contained",color:"primary",onClick:function(){h.updateCard(B).then((function(){W(),L(null)}))},children:"Fertig"})]})]}):(console.log("APP",a.card),Object(A.jsxs)("div",{className:e.root,children:[Object(A.jsx)(y.a,{className:e.card,onClick:function(){return c({type:P})},children:a.card&&Object(A.jsxs)(k.a,{className:e.cardContent,children:[Object.values(a.cardTurned?a.card.translations.to:a.card.translations.from).map((function(t,n){return t?Object(A.jsx)(C.a,{className:e.translations,variant:"subtitle2",children:t},n):null})),a.cardTurned&&a.card.example&&Object(A.jsx)(C.a,{className:e.example,variant:"caption",children:a.card.example}),Object(A.jsx)(S.a,{className:e.cardActions,children:R})]})}),Object(A.jsxs)(w.a,{className:e.speedDial,ariaLabel:"SpeedDial",hidden:!1,icon:Object(A.jsx)(_.a,{}),onClose:function(){return j(!1)},onOpen:function(){return j(!0)},open:d,direction:"up",children:[Object(A.jsx)(N.a,{icon:Object(A.jsx)("span",{className:"material-icons",children:"add"}),tooltipTitle:"Neu",onClick:function(){L({translations:{from:a.user.from.reduce((function(e,t){return Object(u.a)(Object(u.a)({},e),{},Object(s.a)({},t,""))}),{}),to:a.user.to.reduce((function(e,t){return Object(u.a)(Object(u.a)({},e),{},Object(s.a)({},t,""))}),{})},example:""}),j(!1)}}),Object(A.jsx)(N.a,{icon:Object(A.jsx)("span",{className:"material-icons",children:"edit"}),tooltipTitle:"Bearbeiten",onClick:function(){a.card&&L(a.card),j(!1)}}),Object(A.jsx)(N.a,{icon:Object(A.jsx)("span",{className:"material-icons",children:"delete"}),tooltipTitle:"L\xf6schen",onClick:function(){a.card&&m(!0),j(!1)}})]})]}))};o.a.render(Object(A.jsx)(c.a.StrictMode,{children:Object(A.jsx)(F,{})}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.1798e596.chunk.js.map